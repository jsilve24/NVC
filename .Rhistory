expect_equal(fit$ell, ell)
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(.4, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
expect_equal(fit$ell, ell)
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(.4, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
expect_equal(fit$ell, ell)
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(.4, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
expect_equal(fit$ell, ell)
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(.4, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
expect_equal(fit$ell, ell)
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(.4, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
expect_equal(fit$ell, ell)
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(.4, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
expect_equal(fit$ell, ell)
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(.4, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
expect_equal(fit$ell, ell)
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(.4, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
expect_equal(fit$ell, ell)
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(.4, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
expect_equal(fit$ell, ell)
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(.4, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
expect_equal(fit$ell, ell)
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(.4, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
expect_equal(fit$ell, ell)
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(.4, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
expect_equal(fit$ell, ell)
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(.4, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
expect_equal(fit$ell, ell)
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(.4, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
expect_equal(fit$ell, ell)
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(.4, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
expect_equal(fit$ell, ell)
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(.4, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
expect_equal(fit$ell, ell)
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(.4, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
expect_equal(fit$ell, ell)
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(.4, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
expect_equal(fit$ell, ell)
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(.4, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
expect_equal(fit$ell, ell)
test <- function(){
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(.4, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
return (ell - fit$ell)
}
replicate(100, test)
replicate(100, test())
replicate(100, test()) %>% rowMeans()
replicate(100, test()) %>% t %>% summary()
test <- function(){
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(1, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
return (ell - fit$ell)
}
replicate(100, test()) %>% t %>% summary()
expect_equal(fit$ell, ell)
test <- function(){
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(10, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
return (ell - fit$ell)
}
replicate(100, test()) %>% t %>% summary()
expect_equal(fit$ell, ell)
test <- function(){
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(10, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
return (ell - fit$ell)
}
replicate(100, test()) %>% t %>% summary()
expect_equal(fit$ell, ell)
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
U3 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(10, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U3, U2), c(0,0))
fit
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
U3 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(10, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U3), c(0,0))
fit
fit <- optimNVC(y, mu, rbind(U3), c(0))
fit
fit <- optimNVC(y, mu, rbind(U1, U3), c(0))
fit
fit <- optimNVC(y, mu, rbind(U1, U3), c(0,0))
fit
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
U3 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(-100, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U3), c(0,0))
fit
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
fit
U4 <- tcrossprod(rnorm(N))
U4
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
U3 <-  rWishart(1, N+10, diag(N))[,,1]
U4 <- tcrossprod(rnorm(N))
U5 <- tcrossprod(rnorm(N))
ell <- c(10, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(0.0001, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
fit
N <- 1000
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(0.0001, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
expect_equal(fit$ell, ell)
N <- 1000
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(0.0001, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
fit
expect_equal(fit$ell, ell, tolerance=.1)
N <- 100
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
N <- 100
I <- diag(N)
U1 <- diag(N)
# U2 <-  rWishart(1, N+10, diag(N))[,,1]
# U3 <-  rWishart(1, N+10, diag(N))[,,1]
U4 <- tcrossprod(rnorm(N))
U5 <- tcrossprod(rnorm(N))
N <- 100
I <- diag(N)
U1 <- diag(N)
# U2 <-  rWishart(1, N+10, diag(N))[,,1]
# U3 <-  rWishart(1, N+10, diag(N))[,,1]
U4 <- tcrossprod(rnorm(N))
U5 <- tcrossprod(rnorm(N))
ell <- c(10, 3)
N <- 100
I <- diag(N)
U1 <- diag(N)
# U2 <-  rWishart(1, N+10, diag(N))[,,1]
# U3 <-  rWishart(1, N+10, diag(N))[,,1]
U4 <- tcrossprod(rnorm(N))
U5 <- tcrossprod(rnorm(N))
ell <- c(1, 1)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U4
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U5), c(0,0))
fit
N <- 100
I <- diag(N)
U1 <- diag(N)
# U2 <-  rWishart(1, N+10, diag(N))[,,1]
# U3 <-  rWishart(1, N+10, diag(N))[,,1]
U4 <- tcrossprod(rnorm(N))
U5 <- tcrossprod(rnorm(N))
ell <- c(1, 1)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U4
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U5), c(0,0))
expect_equal(fit$ell[1], 1, tolerance=.1)
fit$ell[2] < -3
N <- 1000
I <- diag(N)
U1 <- diag(N)
# U2 <-  rWishart(1, N+10, diag(N))[,,1]
# U3 <-  rWishart(1, N+10, diag(N))[,,1]
U4 <- tcrossprod(rnorm(N))
U5 <- tcrossprod(rnorm(N))
ell <- c(1, 1)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U4
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U5), c(0,0))
expect_equal(fit$ell[1], 1, tolerance=.1)
expect_true(fit$ell[2] < -3)
fit$ell[2]
N <- 1000
I <- diag(N)
U1 <- diag(N)
# U2 <-  rWishart(1, N+10, diag(N))[,,1]
# U3 <-  rWishart(1, N+10, diag(N))[,,1]
U4 <- tcrossprod(rnorm(N))
U5 <- tcrossprod(rnorm(N))
ell <- c(1, 1)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U4
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U5), c(0,0))
expect_equal(fit$ell[1], 1, tolerance=.1)
expect_true(fit$ell[2] < 0)
N <- 1000
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(0.0001, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
expect_equal(fit$ell, ell, tolerance=.1)
N <- 1000
I <- diag(N)
U1 <- diag(N)
U4 <- tcrossprod(rnorm(N))
U5 <- tcrossprod(rnorm(N))
ell <- c(1, 1)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U4
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U5), c(0,0))
expect_true(fit$ell[1] > 1)
expect_true(fit$ell[2] < 0)
devtools::document()
devtools::document()
devtools::load_all(".")
devtools::install)()
?optimNVC
devtools::install()
devtools::document()
devtools::install()
N <- 1000
N <- 1000
I <- diag(N)
U1 <- diag(N)
U2 <-  rWishart(1, N+10, diag(N))[,,1]
ell <- c(0.0001, 3)
Sigma <- exp(ell[1])*U1 + exp(ell[2])*U2
L <- t(chol(Sigma))
mu <- rep(4, N)
y <- mu + L %*% rnorm(N)
fit <- optimNVC(y, mu, rbind(U1, U2), c(0,0))
fit
devtools::install()
load("~/Research/pcrbias/results/2019-02-06_mongrel_first_experiment/")
load("~/Research/pcrbias/results/2019-02-06_mongrel_first_experiment/test_fail.RData")
devtools::load_all(".")
optimNVC(y, mu, U, c(0,0))
devtools::document
devtools::document()
devtools::load_all(".")
optimNVC(y, mu, U, c(0,0))
devtools::load_all(".")
devtools::document()
devtools::load_all(".")
optimNVC(y, mu, U, c(0,0))
?optimNVC
optimNVC(y, mu, U, c(0,0), eps_g=1e-10)
devtools::load_all(".")
optimNVC(y, mu, U, c(0,0), max_iter=1)
optimNVC(y, mu, U, c(0,0), max_iter=3)
devtools::load_all(".")
optimNVC(y, mu, U, c(0,0), max_iter=3)
U
tail(U)
y
optimNVC(scale(y), mu, U, c(0,0), max_iter=3)
optimNVC(scale(y), mu, U, c(0,0))
